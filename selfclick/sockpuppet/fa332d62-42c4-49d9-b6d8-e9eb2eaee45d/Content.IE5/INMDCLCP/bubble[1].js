(function(){var e;e=new RegExp("development").test(sdk.env),window.config={enable:!0,qing_ad:168,intervalBetweenTwoBubbles:e?18e5:36e5,configListLoadInterval:36e5,pluginReloadMaxNum:1,bubble_popup_info_probability:.01,page_reload_time_interval:36e5,service_reload_time_interval:36e5,process_exit_timeout:18e5,update_history_interval:216e6,maxReloadNumADay:3}}).call(this);
(function(){window.constant={BUBBLE_LAST_LOAD_TIME:"time_last_load",STORAGE_KEY_LAST_EXEC_TIME:"time_last_exec",STORAGE_KEY_BUBBLE_DATE_POPUP:"time_popup",STORAGE_KEY_BUBBLE_DATE_CLICK:"time_click",STORAGE_KEY_BUBBLE_DATE_CLOSE:"time_close",STORAGE_KEY_BUBBLE_CLOSE_TYPE:"close_type",INI_PRE_KEY_BUBBLE_FAIL_LAST_SENT_TIME:"time_bubble_file_info_last_sent",FEATURE_WINDOW_PREFIX:"DD6CB1B6-9571-4450-8206-E9BA4A574C3E",TYPE_CLOSE_BY_CLOSE_BTN:1,TYPE_CLOSE_BY_NORMAL_CLICK_EVENT:2,TYPE_CLOSE_BY_TIMEOUT:3,TYPE_CLOSE_BY_FORCE:4,TYPE_CLOSE_BY_NOT_INTERESTED:5,TYPE_CLOSE_BY_RETRY:6,TYPE_CLOSE_BY_TRY_CLICK_HAT:7,TYPE_CLOSE_BY_AS_HIDDEN:8,TYPE_CLOSE_BY_WEBVIEW_STOP:9,TYPE_CLOSE_BY_CMD:10,TYPE_CLOSE_BY_VIP_GUIDE:11,TYPE_CLOSE_BY_RELOAD:12,TYPE_CLOSE_BY_NON_HEARTBEAT:13,TYPE_CLOSE_BY_OVERLAY_GROUP:14,TYPE_CLOSE_BY_MIDNIGHT_RELOAD:15,CODE_REASON_LAST_EXIT_ABNORMAL:"0",CODE_REASON_LAST_EXIT_SHUTDOWN:"1",CONE_REASON_LAST_EXIT_NORMAL:"5",HIDDEN_CODE:{QT:1,WINDOWS:2,LOCATION:3,SIZE:4},DOUBTFUL_PROCESS:{"zhudongfangyu.exe":1,"360tray.exe":2,"sogoucloud.exe":3,"sgtool.exe":4,"360bdoctor.exe":5,"wdswfsafe.exe":6,"360se.exe":7,"360sd.exe":8,"qqpcrtp.exe":9,"securityhealthservice.exe":10,"softupnotify.exe":11,"sohunews.exe":12,"navplugin.exe":13,"qykernel.exe":14,"computerzservice.exe":15,"kxescore.exe":16,"kxetray.exe":17,"popwndlog.exe":18,"360leakfixer.exe":19,"360desktoplite64.exe":20,"2345pinyincloud.exe":21,"protect_2345explorer.exe":22,"pinyin_2345svc.exe":23,"haozipsvc.exe":24,"qqpctray.exe":25},POPUP_FAIL_CODE:{PAID_USER:1,SOFTWARE:2,PROCESS:3,DESKTOP_LINKS:4,TASKBAR_LINKS:5,REGISTRY:6,CONDFUNC:7,CONTINUE_CLOSE:8,PEOJECTOR_CONNECTED:9,GLOBAL_AD:10,CLIENT_AD:11,CLIENT_NEW_INSTALL_USER:13,SCREEN_SAVER_PROCESS:15,REG_DELAY:16,SHIELD_INTERCEPTOR:17,EDU_VERSION:18,CLICK_MUTEX:19,SPEC_DIST_NEW_INSTALL_USER:20}}}).call(this);
(function(){var BubbleBase,isTimeEffect;isTimeEffect=function(){var t,e;return e=function(t){var e,s,i,o,n,r,a,u,l,c,f,d,h;for(null==t&&(t=""),f=[],u="\n",o=/(\d{4}.*\d{2}.*\d{2}.*\d{2}.*\d{2}.*\d{2}).*(\d{4}.*\d{2}.*\d{2}.*\d{2}.*\d{2}.*\d{2})/,d=t.split(u),n=0,r=d.length;n<r;n++){l=d[n];try{a=l.match(o),a instanceof Array&&(h=a[1],c=a[2],e=[sdk.util.parseDate(h),sdk.util.parseDate(c)]),f.push(e)}catch(i){s=i}}return f},t=function(t){var e,s,i,o,n,r;for(null==t&&(t=[]),n=new Date,i=0,o=t.length;i<o;i++){r=t[i];try{if(r[0]<=n&&r[1]>=n)return!0}catch(s){e=s}}return!1},function(s){var i;return i=e(s),t(i)}}(),BubbleBase=function(){function BubbleBase(t){var e,s,i,o,n,r,a,u,l,c,f;for(this.config=t,this.appName=sdk.client.info.getAppName(),this.keyPluginLastLoadTime="plugin_last_load_time_"+this.appName,this.alive=!1,this.observer=new sdk["class"].Observer,this._id=this.config._id,this.is_ad="1"===this.config.is_ad||"2"===this.config.is_ad||"3"===this.config.is_ad,this.storageKeyGroup="bubble_"+this._id,this.storageKeyExecNum="exec_num_all",this.storageKeyLastExecTime="last_exec_time",this.storageKeyContinueCloseNum="continue_close_num",this.storageKeyExecNumTodayPrefix="exec_num",this.storageKeyLastFailInfoSetTime="last_fail_info_sent_time",this.clientName=sdk.client.info.getAppName(),this.storageClientLastExecAdTime=this.storageGlobalLastExecAdTime="last_exec_ad_time",this.storageKeyLastSceneAdTime="last_exec_scene_ad_time",this.storageKeyLastNonSceneAdTime="last_exec_non_scene_ad_time",this.storageGlobalLastMonthAdTime="last_30day_ad_time",this.storageGlobalLastWeekSceneAdTime="last_7day_scene_ad_time",this.taskbarLinks=(this.config._taskbar_links||"").toLowerCase(),this.desktopLinks=(this.config._desktop_links||"").toLowerCase(),this.softList=this.config._soft_list||"",this.processList=(this.config._process_list||"").toLowerCase(),this.regList=this.config._reg_list||"",this.condFunc=this.config._cond_func||"function(){return true}",this.condFunc="("+this.condFunc+")('"+this._id+"', '"+this.config._name+"')",this.enabled=this.config._enabled-0,this.exceptPaidUser="1"===(this.config._expect_paid_user||"1"),this.shieldInterceptor="1"===(this.config._shield_interceptor||"1"),this.timeEffect=this.config._time_effect,this.timeSlot=this.config._time_slot||"00:00-24:00",this.effectTimeInterval=6e4*(this.config._time_interval-0)||3e5,this.globalTimeInterval=6e4*(this.config._adSpecial_time_interval-0)||config.intervalBetweenTwoBubbles,this.maxNumaDay=this.config._number_everyday||1,this.maxNum=this.config._number_total||5,this.autoCloseTimeout=6e4*(this.config.time_auto_close-0||1e3),this.notifyGroup=[],c=(this.config._group_name||"").split(";"),o=0,a=c.length;o<a;o++)l=c[o],l&&this.notifyGroup.push(l);if(this.overlayGroup=this.config.overlay_group||"",this.script=this.config.script||"function(){}",this.timeExecDelay=6e4*this.config._time_delay||0,this.disabledPageReload=!!-this.config._disabled_page_reload,this.config.continue_close_set)try{for(e=this.config.continue_close_set.split(","),n=r=0,u=e.length;r<u;n=++r)f=e[n],e[n]=f.split("=");this.continueCloseShield=e}catch(i){s=i}this._backupGlobalLastExecDate(),this.initReport()}return BubbleBase.prototype.canPopup=function(t,e,s){return null==s&&(s=sdk.noop),!this.isValid()||this.isAlive()||this.executing?s(!1):this.isValidAsyn(t,e,function(t){return function(e){return sdk.noop(),s(e&&!t.isAlive()&&!t.executing&&t.isValid()?!0:!1)}}(this))},BubbleBase.prototype.exec=function(){return this.executing=!0,sdk.noop(),sdk.client.plugin.stopExit(),this.alive=!0,this instanceof CustomBubble||this._setGlobalLastExecDate(),this._feedbackExec(this.config._id,config.bubble_popup_info_probability),this.setBubbleInfo({adType:this.getAdType()}),this.executing=!1},BubbleBase.prototype.recordPopup=function(){return this._setLastExecDate(),this._addExecNumToday(),this._addExecNumTotal()},BubbleBase.prototype.isAlive=function(){return this.alive},BubbleBase.prototype._feedbackExec=function(t,e){if(1===Math.ceil(Math.random()/e))return sdk.util.justSend("http://pcfg.wps.cn:9002/config/info/popupTry/"+t+"/"+e+"/0")},BubbleBase.prototype.matchNotify=function(msg,info,callback){var browserName,cb,hours,keyword,pid;if("browsetheweb"===msg&&info)try{info=eval("("+info+")"),pid=info.pid,browserName=info["browserName".toLowerCase()],info=sdk.bubble.rmBrowserName(info.title)}catch(undefined){}if(/^browsetheweb_common/.test(msg))try{info=eval("("+info+")"),pid=info.pid,browserName=info.name,info=info.text}catch(undefined){}return sdk.noop(),cb=function(t){return function(e){return e&&t.recordNotify(msg,info,e,pid,browserName),callback&&callback(e),e}}(this),msg?0===this.notifyGroup.length&&"kscreensaver_comeback"!==msg?cb(!0):sdk.util.indexOf(msg,this.notifyGroup)>-1?this.config._group_info?(hours=this.config._include_history_hours-0,hours&&"ruby"===sdk.platform?(keyword=sdk.bubble.ifMatchTags(info,this.config._group_info))?cb(keyword):sdk.system.getRecentBrowserHistoryTitle(hours,function(t){return function(e){var s,i,o;for(s=0,i=e.length;s<i;s++)if(o=e[s],keyword=sdk.bubble.ifMatchTags(o,t.config._group_info))return info=o,cb(keyword);return cb(!1)}}(this)):cb(info?sdk.bubble.ifMatchTags(info,this.config._group_info):!1)):cb("null"):cb(!1):cb(0===this.notifyGroup.length)},BubbleBase.prototype.recordNotify=function(t,e,s,i,o){if(t&&this.setMsgGroupName(t),s&&this.setMsgGroupKeyword(s),e&&this.setMsgGroupInfo(e),i&&this.setBubbleInfo({msgPid:i}),o)return this.setBubbleInfo({msgBrowser:o})},BubbleBase.prototype.popupIntervalCheck=function(){var t;return t=sdk.util.getNow(),this instanceof CustomBubble||!(t-this._getGlobalLastExecDate()<this.globalTimeInterval)||(this.failedReason=4,sdk.noop(),sdk.noop(),!1)},BubbleBase.prototype.isValid=function(){var condRet,err,error,error1,i,len,now,path,ref,shield,userInfo;if(now=sdk.util.getNow(),this.failedReason=0,this.alive)return this.failedReason=1,sdk.noop(),!1;if(this.is_ad&&sdk.client.info.getAdType()!==this.config.is_ad)return sdk.noop(),!1;if("true"===sdk.system.getReg("skipClientFilter","HKEY_CURRENT_USER\\Software\\Kingsoft\\Office\\6.0\\plugins\\kbubble\\")&&!(this instanceof CustomBubble))return!0;if(now-this._getLastExecDate()<this.effectTimeInterval)return this.failedReason=3,sdk.noop(),sdk.noop(),!1;if(!this.popupIntervalCheck())return!1;if(this.is_ad){if(sdk.client.info.isSpecDistNewUser())return this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.SPEC_DIST_NEW_INSTALL_USER),sdk.noop(),!1;if(sdk.client.info.isInstallNewUser())return this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.CLIENT_NEW_INSTALL_USER),sdk.noop(),!1;if("windows xp"===sdk.system.getOsName()&&sdk.util.indexOf("kscreensaverapp.exe",sdk.system.listProcesses())>=0)return this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.SCREEN_SAVER_PROCESS),sdk.noop(),!1;if(this._hasInstallWps()){if("1"===this.config.is_ad){if(this._getGlobalLastMonthAdNum()>=4)return this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.GLOBAL_AD),sdk.noop(),!1;if("1"===this.config.have_priority){if(now-this._getGlobalLastExecAdTime()<864e5)return this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.GLOBAL_AD),sdk.noop(),!1}else if(now-this._getGlobalLastExecAdTime()<1e3*(config.qing_ad-0)*3600)return this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.GLOBAL_AD),sdk.noop(),!1}if("2"===this.config.is_ad){if(this._getGlobalLastMonthAdNum()>=8)return this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.GLOBAL_AD),sdk.noop(),!1;if("material_bubble"===this.config._template_type){if(this._getGlobalLastWeekSceneAdNum()>=2&&"1"!==this.config.have_priority)return sdk.noop(),!1}else if("1"!==this.config.have_priority&&now-this._getGlobalLastExecNonSceneAdTime()<6048e5)return sdk.noop(),!1}if("3"===this.config.is_ad&&this._getGlobalLastMonthAdNum()>=6)return this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.GLOBAL_AD),sdk.noop(),!1}else if(config[this.clientName+"_ad"]&&now-this._getLastExecAdTime()<1e3*(config[this.clientName+"_ad"]-0)*3600)return this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.CLIENT_AD),sdk.noop(),sdk.noop(),!1}if(sdk.system.isAnyProcessFullScreen()&&!sdk.existsApi("krwebview.setZOrder"))return this.failedReason=5,sdk.noop(),!1;if(sdk.system.isProjectorConnected())return this.failedReason=7,sdk.noop(),this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.PEOJECTOR_CONNECTED),!1;if(!isTimeEffect(this.timeEffect))return this.failedReason=6,sdk.noop(),!1;if(!this._inTimeSlot())return this.failedReason=8,sdk.noop(),!1;if(this.config._substance_group&&this.config._substance_interval&&(this.substanceMutex=!0,!sdk.bubble.checkSubstanceMutex(this.config._substance_group,this.config._substance_interval)))return this.failedReason=19,sdk.noop(),!1;if(this._getExecNumToday()>=this.maxNumaDay)return this.failedReason=9,sdk.noop(),!1;if(this._getExecNumTotal()>=this.maxNum)return this.failedReason=10,sdk.noop(),!1;if(this.continueCloseShield&&this.continueCloseShield.length>0)for(ref=this.continueCloseShield,i=0,len=ref.length;i<len;i++){shield=ref[i];try{if(shield[0]-0===this._getContinueCloseNum()&&now-this._getLastExecDate()<1440*shield[1]*6e4)return this.failedReason=11,sdk.noop(),this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.CONTINUE_CLOSE),!1}catch(error){err=error,sdk.noop()}}if(now-this._getAgentLastLoadTime()<this.timeExecDelay&&this.timeExecDelay>0)return this.failedReason=12,sdk.noop(),!1;if(0===this.enabled)return this.failedReason=13,sdk.noop(),!1;if(this.exceptPaidUser&&sdk.client.user.isPaidUser()&&(userInfo=sdk.client.plugin.getUserInfoData(),!("41000207"===userInfo.companyID&&userInfo["c-name"].indexOf("金山办公")>-1)))return this.failedReason=14,sdk.noop(),this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.PAID_USER),!1;if(this.exceptPaidUser&&sdk.client.info.isEduVersion())return sdk.noop(),this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.EDU_VERSION),!1;if(this.exceptPaidUser&&sdk.client.user.isComplainedUser())return sdk.noop(),!1;if(path=sdk.system.getFolderPath(35)||"C:/ProgramData",this.shieldInterceptor&&sdk.util.indexOf("qg",sdk.as.getAsProcess("name"))>-1&&sdk.system.isPathExists(path+"/Tencent/QQPCMgr/AdBlock/userconfig.dat"))return sdk.noop(),this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.SHIELD_INTERCEPTOR),!1;if(this.softList&&!this._ifInInOutObj(this.softList,sdk.system.listSoftWare()))return this.failedReason=15,sdk.noop(),this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.SOFTWARE),!1;if(!this._ifInInOutObj(this.processList,sdk.system.listProcesses()))return this.failedReason=16,sdk.noop(),this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.PROCESS),!1;if(!this._ifInInOutObj(this.desktopLinks,sdk.system.listDesktopLinks()))return this.failedReason=17,sdk.noop(),this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.DESKTOP_LINKS),!1;if(!this._ifInInOutObj(this.taskbarLinks,sdk.system.listTaskbarLinks()))return this.failedReason=18,sdk.noop(),this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.TASKBAR_LINKS),!1;if(!this._ifValidReg(this.regList))return this.failedReason=19,sdk.noop(),this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.REGISTRY),!1;try{condRet=eval(this.condFunc)}catch(error1){err=error1,sdk.noop(),condRet=!1}finally{if(!condRet)return this.failedReason=20,sdk.noop(),this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.CONDFUNC),!1}return!0},BubbleBase.prototype.isValidAsyn=function(msg,info,cb){var callback,funcIndex,funcQueue;return funcQueue=[],funcQueue.push(function(t){return function(){return t.matchNotify(msg,info,function(t){return t||sdk.noop(),callback(t)})}}(this)),funcQueue.push(function(t){return function(){return"1"===t.config._check_realtime_valid?t._ifConfigValid(function(t){return t||sdk.noop(),callback(t)}):callback(!0)}}(this)),funcQueue.push(function(_this){return function(){var cb1,err,error,func,funcStr,name,timer;if(!_this.config._cond_func_async)return callback(!0);name=_this.config._name,cb1=null,timer=setTimeout(function(){return sdk.noop(),cb1=sdk.noop,callback(!1)},3e4),cb1=function(t){return clearTimeout(timer),cb1=sdk.noop,t||sdk.noop(),callback(!!t)};try{return funcStr="false||("+_this.config._cond_func_async+")",(func=eval(funcStr))(_this.config._id,_this.config._name,function(t){return cb1(t)})}catch(error){return err=error,sdk.noop(),cb1(!1)}}}(this)),funcIndex=0,(callback=function(t){return function(t){return funcIndex>=funcQueue.length?cb&&cb(t):t?(funcIndex++,funcQueue[funcIndex-1]()):cb&&cb(t)}}(this))(!0)},BubbleBase.prototype._sendPopupFailInfo=function(t){if(!(sdk.util.getNow()-this._getBubbleLastPopupFailInfoSentTime()<864e5||"1"===this.config._disabled_popup_fail_info))return this._setBubbleLastPopupFailInfoSentTime(),sdk.service.info.bubblePopupFail(this._id,this.config._name,t)},BubbleBase.prototype._string2InOutObj=function(t){var e,s,i,o,n,r,a,u;null==t&&(t=""),a=/^\-.*/;try{e=t.split(",")}catch(i){s=i,e=[]}for(r={"in":{},out:{}},o=0,n=e.length;o<n;o++)u=e[o],u=u.replace(/^\s/g,"").replace(/\s$/g,""),u&&(a.test(u)?r.out[u.replace(/^\-/,"")]=!0:r["in"][u.replace(/^\+/,"")]=!0);return r},BubbleBase.prototype._ifInInOutObj=function(t,e){var s,i,o,n,r;for(r=this._string2InOutObj(t),n={},s=0,o=e.length;s<o;s++)i=e[s],n[i]=!0;for(i in r["in"])if(!n[i])return!1;for(i in r.out)if(n[i])return!1;return!0},BubbleBase.prototype._ifValidReg=function(t){var e,s;s=this._string2InOutObj(t);for(e in s["in"])if(!sdk.system.existsRegKeyOrPath(e))return sdk.noop(),!1;for(e in s.out)if(sdk.system.existsRegKeyOrPath(e))return sdk.noop(),!1;return!0},BubbleBase.prototype._inTimeSlot=function(){var t,e,s,i,o,n,r;if(i=sdk.util.getNow(),!this.timeSlot)return!0;for(n=!1,o=this.timeSlot.split(/[,|，|;]/),t=function(t){return function(t){var e,s,o;if(o=t.split("-"),e=sdk.util.parseTime(o[0]),s=sdk.util.parseTime(o[1]),i>=e&&i<=s)return n=!0}}(this),e=0,s=o.length;e<s;e++)r=o[e],t(r);return n},BubbleBase.prototype._setGlobalLastExecDate=function(){var t;return t=new sdk.util.getNow,sdk.tools.storage.set(constant.STORAGE_KEY_LAST_EXEC_TIME,t-0)},BubbleBase.prototype._getGlobalLastExecDate=function(){var t;return t=sdk.tools.storage.get(constant.STORAGE_KEY_LAST_EXEC_TIME),t?new Date(t-0):null},BubbleBase.prototype._backupGlobalLastExecDate=function(){return this.globalLastExecTime=this._getGlobalLastExecDate()-0},BubbleBase.prototype._rollbackGlobalLastExecDate=function(){return sdk.tools.storage.set(constant.STORAGE_KEY_LAST_EXEC_TIME,this.globalLastExecTime||"")},BubbleBase.prototype._setLastExecDate=function(){var t;return t=sdk.util.getNow(),sdk.tools.storage.set(this.storageKeyLastExecTime,t-0,this.storageKeyGroup)},BubbleBase.prototype._getLastExecDate=function(){var t;return t=sdk.tools.storage.get(this.storageKeyLastExecTime,this.storageKeyGroup),t?new Date(t-0):null},BubbleBase.prototype._setLastExecAdTime=function(){var t;return t=sdk.util.getNow(),sdk.tools.storage.set(this.storageClientLastExecAdTime,t-0,this.clientName)},BubbleBase.prototype._getLastExecAdTime=function(){var t;return t=sdk.tools.storage.get(this.storageClientLastExecAdTime,this.clientName),t?new Date(t-0):null},BubbleBase.prototype._setGlobalLastExecAdTime=function(){var t,e;return t=sdk.util.getNow(),sdk.tools.storage.set(this.storageGlobalLastExecAdTime,t-0),e=sdk.tools.storage.get(this.storageGlobalLastMonthAdTime).split("|"),e.sort(),e.push(t-0),sdk.tools.storage.set(this.storageGlobalLastMonthAdTime,e.join("|")),"material_bubble"===this.config._template_type?(sdk.tools.storage.set(this.storageKeyLastSceneAdTime,t-0),e=sdk.tools.storage.get(this.storageGlobalLastWeekSceneAdTime).split("|"),e.sort(),e.push(t-0),sdk.tools.storage.set(this.storageGlobalLastWeekSceneAdTime,e.join("|"))):sdk.tools.storage.set(this.storageKeyLastNonSceneAdTime,t-0)},BubbleBase.prototype._getGlobalLastExecAdTime=function(){var t;return t=sdk.tools.storage.get(this.storageGlobalLastExecAdTime),t?new Date(t-0):null},BubbleBase.prototype._getGlobalLastExecSceneAdTime=function(){var t;return t=sdk.tools.storage.get(this.storageKeyLastSceneAdTime),t?new Date(t-0):null},BubbleBase.prototype._getGlobalLastExecNonSceneAdTime=function(){var t;return t=sdk.tools.storage.get(this.storageKeyLastNonSceneAdTime),t?new Date(t-0):null},BubbleBase.prototype._getGlobalLastMonthAdNum=function(){var t,e,s,i,o,n;for(t=sdk.util.getNow()-2592e6,o=sdk.tools.storage.get(this.storageGlobalLastMonthAdTime).split("|"),e=0,s=0,i=o.length;s<i;s++)n=o[s],n-0<=t&&e++;return e&&(o=o.slice(e),sdk.tools.storage.set(this.storageGlobalLastMonthAdTime,o.join("|"))),o.length},BubbleBase.prototype._getGlobalLastWeekSceneAdNum=function(){var t,e,s,i,o,n;for(t=sdk.util.getNow()-6048e5,o=sdk.tools.storage.get(this.storageGlobalLastWeekSceneAdTime).split("|"),e=0,s=0,i=o.length;s<i;s++)n=o[s],n-0<=t&&e++;return e&&(o=o.slice(e),sdk.tools.storage.set(this.storageGlobalLastWeekSceneAdTime,o.join("|"))),o.length},BubbleBase.prototype._addExecNumToday=function(){var t,e,s;return e=this._getExecNumToday()+1,t=sdk.util.getNow(),s=sdk.util.formatDate(t,"yyyy_MM_dd"),sdk.tools.storage.set(this.storageKeyExecNumTodayPrefix+"_"+s,e,this.storageKeyGroup)},BubbleBase.prototype._getExecNumToday=function(){var t,e;return t=sdk.util.getNow(),e=sdk.util.formatDate(t,"yyyy_MM_dd"),sdk.tools.storage.get(this.storageKeyExecNumTodayPrefix+"_"+e,this.storageKeyGroup)-0||0},BubbleBase.prototype._addExecNumTotal=function(){var t;return t=this._getExecNumTotal()+1,sdk.tools.storage.set(this.storageKeyExecNum,t,this.storageKeyGroup)},BubbleBase.prototype._getExecNumTotal=function(){return sdk.tools.storage.get(this.storageKeyExecNum,this.storageKeyGroup)-0||0},BubbleBase.prototype._addContinueCloseNum=function(){var t;return t=this._getContinueCloseNum()+1,sdk.noop(),sdk.tools.storage.set(this.storageKeyContinueCloseNum,t,this.storageKeyGroup)},BubbleBase.prototype._resetContinueCloseNum=function(){return sdk.tools.storage.set(this.storageKeyContinueCloseNum,0,this.storageKeyGroup)},BubbleBase.prototype._getContinueCloseNum=function(){return sdk.noop(),sdk.tools.storage.get(this.storageKeyContinueCloseNum,this.storageKeyGroup)-0||0},BubbleBase.prototype._getAgentLastLoadTime=function(){return new Date(sdk.tools.storage.get(this.keyPluginLastLoadTime)-0)||sdk.util.getNow()},BubbleBase.prototype._getBubbleLastPopupFailInfoSentTime=function(){return sdk.tools.storage.get(this.storageKeyLastFailInfoSetTime,this.storageKeyGroup)-0||0},BubbleBase.prototype._setBubbleLastPopupFailInfoSentTime=function(){return sdk.tools.storage.set(this.storageKeyLastFailInfoSetTime,sdk.util.getNow()-0,this.storageKeyGroup)},BubbleBase.prototype._hasInstallWps=function(){return sdk.system.existsRegKeyOrPath("HKEY_CURRENT_USER\\Software\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\Kingsoft Office\\DisplayVersion")},BubbleBase.prototype._ifConfigValid=function(cb){return sdk.util.ajax({url:"http://pcfg.wps.cn/config/"+this._id+"/ifValid",type:"get",timeout:10,success:function(ret){var error,valid;sdk.noop();try{if(valid=eval("("+ret+")"),valid=valid.data)return cb(!0)}catch(error){sdk.noop()}return cb(!1)},error:function(t){return sdk.noop(),cb(!1)}})},BubbleBase.prototype.initReport=function(){return sdk.service.info.bubbleInit(this._id,this.config.bubble_name)},BubbleBase.prototype.setMsgGroupName=function(t){return this.msg=t,this.setBubbleInfo({msg:t})},BubbleBase.prototype.getMsgGroupName=function(){return this.msg||""},BubbleBase.prototype.setMsgGroupInfo=function(t){return sdk.util.iniCache.set(this._id+"_msgInfo",t),this.setBubbleInfo({msgInfo:t})},BubbleBase.prototype.getMsgGroupInfo=function(){return sdk.util.iniCache.get(this._id+"_msgInfo")},BubbleBase.prototype.setMsgGroupKeyword=function(t){return this.msgKeyword=t,this.setBubbleInfo({keyword:t})},BubbleBase.prototype.getMsgGroupKeyword=function(){return this.msgKeyword||""},BubbleBase.prototype.setBubbleInfo=function(t){var e,s,i;s=[];for(e in t)i=t[e],s.push(sdk.util.iniCache.set(this._id+"_"+e,i));return s},BubbleBase.prototype.destroy=function(){return this.alive=!1,this.observer.fire("destroy")},BubbleBase.prototype.getAdType=function(){return"1"===this.config.is_ad||"2"===this.config.is_ad||"3"===this.config.is_ad?"ad_normal":"0"!==this.config.is_ad||"commercial"!==this.config.purpose&&"own_product"!==this.config.purpose?"feature":"ad_special"},BubbleBase}(),window.BubbleBase=BubbleBase}).call(this);
(function(){var NormalBubble,appName,extend=function(t,e){function i(){this.constructor=t}for(var n in e)hasProp.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;appName=sdk.client.info.getAppName(),NormalBubble=function(superClass){function NormalBubble(t){NormalBubble.__super__.constructor.call(this,t),this.retryNum=0,this.script_after_close=t.script_after_close,this.afterCreateFunc=this.config._after_create_func||"function(){return true}",this.afterExecFunc=this.config._after_exec_func||"function(){return true}"}return extend(NormalBubble,superClass),NormalBubble.prototype.isValid=function(){var t,e;return!!NormalBubble.__super__.isValid.call(this)&&(/^11\./.test(sdk.client.info.getAppVersion())&&sdk.util.indexOf("qg",sdk.as.getAsProcess("name"))>-1&&!sdk.client.plugin.isRunInWps()?(sdk.noop(),!1):/00020\.00002578|00020\.00002579|00020\.00002642/.test(sdk.client.info.getDistNum())?(sdk.noop(),!1):(sdk.noop(),sdk.client.plugin.bubbleDisabled()&&"wps_upgrade"!==this.config._group_name?(sdk.noop(),!1):!(!this.config._group_name&&(t=sdk.system.getReg("freedom","HKEY_CURRENT_USER\\Software\\kingsoft\\Office\\6.0\\plugins\\kbubble")-0,e=new Date-0,e>=t&&e<t+3e5))||(sdk.noop(),this._sendPopupFailInfo(constant.POPUP_FAIL_CODE.REG_DELAY),!1)))},NormalBubble.prototype.tryExec=function(t){var e,i,n;return e=this._id,i=sdk.tools.observer.on(e+"_show",function(e){return function(){return sdk.tools.observer.clean(i),t&&t(!0)}}(this)),n=sdk.tools.observer.on(e+"_stop",function(e){return function(){return e.close(constant.TYPE_CLOSE_BY_WEBVIEW_STOP),e._rollbackGlobalLastExecDate(),sdk.tools.observer.clean(n),t&&t(!1)}}(this)),this.exec()},NormalBubble.prototype.parseContentConfig=function(){var t,e,i,n,o,s,r,u,c,a,l;if(s=0,u=0,l=this.config.frame_width,i=this.config.frame_height,c=this.config.frame_url,t=null,"undefined"!=typeof this.config.abTest_popup_max&&(a=c.split("\n"),a.length>1)){e=parseInt(sdk.client.info.getHdid().substr(0,2),16)%a.length;try{t=a[e].match(/([a-zA-Z0-9]{32})/)[1]}catch(d){t=""}c=sdk.util.createGetUrl(a[e],{bubble_testId:t})}return c=sdk.util.createGetUrl(c,{bubble_msg:this.getMsgGroupName()}),r=sdk.util.getUrlParam("bubble_wh",c),r&&(n=r.indexOf("_"))>-1&&(l=r.substr(0,n),i=r.substr(n+1)),n=l.indexOf("~"),n>-1&&(s=l.substr(n+1),l=l.substr(0,n)),n=i.indexOf("~"),n>-1&&(u=i.substr(n+1),i=i.substr(0,n)),sdk.noop(),sdk.noop(),o={isAd:this.config.is_ad||0,traceProbability:this.config.trace_probability,substanceGroup:this.config._substance_group},t&&(o.abTestId=t),this.setBubbleInfo(o),{width:l,height:i,url:c,bubbleTestId:t,leftMargin:s,topMargin:u}},NormalBubble.prototype.setNormalBubbleInfo=function(t){var e,i,n;i=[];for(e in t)n=t[e],i.push(sdk.util.iniCache.set(this._id+"_"+e,n));return i},NormalBubble.prototype.exec=function(){var bubbleId,bubbleName,content,err,error,execFunc,view;if(NormalBubble.__super__.exec.apply(this,arguments),this.executing=!0,this.alive=!1,bubbleId=this._id,bubbleName=this.config._name,content=this.parseContentConfig(),this.view=view=sdk.client.webview.generateRightBottomBubble(content.width,content.height,content.url,bubbleId,bubbleName,this.config.link_click_auto_close,this.autoCloseTimeout,sdk.noop,function(t){return function(){return t.alive=!0}}(this),function(t){return function(){return t._resetContinueCloseNum()}}(this),config.syncCookieDomainList,this.config.class_name||""),this.config.hasOwnProperty("drag_left")&&this.view.setDragArea(this.config.drag_left,this.config.drag_top,this.config.drag_right,this.config.drag_bottom),this.setBubbleMsgId(),(content.leftMargin||content.topMargin)&&this.enableWindowProtection(content.leftMargin,content.topMargin),this.setWindowShieldCallback(),this.enableWindowProtectionNotify(),this.hertbeatToken=sdk.tools.observer.on(bubbleId+"_heartbeat",function(t){return function(){var e;return e=setInterval(function(){var i;if(i=new Date,t.alive&&t.visible&&i-t.lastBeat>18e4)return t.close(constant.TYPE_CLOSE_BY_NON_HEARTBEAT),sdk.util.justSend("http://pcfg.wps.cn:9002/report/error/forceClosed/"+bubbleId+"/"+bubbleName+"/"+appName+"/"+t.retryNum),clearInterval(e)},6e4),function(){return t.lastBeat=new Date}}}(this)()),this.showToken=sdk.tools.observer.on(bubbleId+"_show",function(_this){return function(){return _this.showTimeout=setTimeout(function(){return _this.retryNum++,sdk.util.justSend("http://pcfg.wps.cn:9002/report/error/showFailed/"+bubbleId+"/"+bubbleName+"/"+appName+"/"+_this.retryNum),_this.retryNum<=3?(_this.executing=!1,_this.close(constant.TYPE_CLOSE_BY_RETRY),sdk.noop(),_this.exec()):(_this.executing=!1,_this.close(constant.TYPE_CLOSE_BY_FORCE),sdk.noop(),_this._rollbackGlobalLastExecDate())},18e4),function(){var date,err,error,execFn,execFunc,zOrder;_this.executing=!1,_this.visible=!0,clearTimeout(_this.showTimeout),window.config.overlayKilled&&_this.overlayGroup&&(sdk.noop(),sdk.tools.observer.fire("overlayGroupInfo",_this._id,_this.overlayGroup)),sdk.noop(),sdk.tools.observer.fire("killOthers",_this._id),date=sdk.util.getNow()-0,execFn="var value = document.getElementById('close-btn'); if(value && value.offsetWidth){ sdk.util.iniCache.set('cCloseBtnSize', value.offsetWidth); }",sdk.client.webview.execute(_this.view.id,execFn),_this.setBubbleInfo({zOrder:sdk.system.isAnyProcessFullScreen()?0:100}),sdk.service.info.popup(bubbleId,bubbleName,content.bubbleTestId,_this.getMsgGroupName()),sdk.tools.storage.set(constant.STORAGE_KEY_BUBBLE_DATE_POPUP,date,_this.storageKeyGroup),_this.recordPopup(),_this.is_ad&&_this._setLastExecAdTime(),_this.is_ad&&_this._setGlobalLastExecAdTime(),setTimeout(function(){var t;if(sdk.noop(),_this.alive&&(t=view.isHidden()))return sdk.service.info.hidden(bubbleId,bubbleName,t)},1e4);try{execFunc=eval("(function() {return "+_this.afterExecFunc+"})()"),execFunc(_this._id,_this.config._name,_this)}catch(error){err=error,sdk.noop()}return zOrder=sdk.util.iniCache.get(_this._id+"_zOrder"),view.show(zOrder)}}}(this)()),this.closeToken=sdk.tools.observer.on("window_close",function(_this){return function(id,type){var err,error;if(null==type&&(type=2),sdk.noop(),type===constant.TYPE_CLOSE_BY_MIDNIGHT_RELOAD)return _this.close(type),void sdk.noop();if(view.id===id||bubbleId===id){switch(type){case constant.TYPE_CLOSE_BY_CLOSE_BTN:case constant.TYPE_CLOSE_BY_NOT_INTERESTED:_this._addContinueCloseNum(),sdk.noop();break;default:_this._resetContinueCloseNum(),sdk.noop()}if(_this.script_after_close)try{eval("("+_this.script_after_close+")('"+bubbleId+"', '"+bubbleName+"', "+type+")")}catch(error){err=error,sdk.noop()}return _this.close(type)}}}(this)),sdk.tools.observer.on("window_hide_"+view.id,function(t){return function(){return view.hide()}}(this)),sdk.tools.observer.on("window_resize_"+view.id,function(t){return function(t,e){return view.resize(t,e),view.moveToRightBottom()}}(this)),sdk.tools.observer.on("window_setDragArea_"+view.id,function(t){return function(t,e,i,n){return view.setDragArea(t,e,i,n)}}(this)),sdk.tools.observer.on("window_setDragAreaEx_"+view.id,function(t){return function(e,i,n,o){return t.setDragAreaEx(e,i,n,o)}}(this)),sdk.noop(),setTimeout(function(t){return function(){if(t.view.valid())return t.view.isVisible()?(sdk.util.justSend("http://pcfg.wps.cn:9002/report/config/"+bubbleId+"/visible"),sdk.noop()):(sdk.util.justSend("http://pcfg.wps.cn:9002/report/config/"+bubbleId+"/hidden"),sdk.noop()),t.close(constant.TYPE_CLOSE_BY_TIMEOUT)}}(this),this.autoCloseTimeout),this.afterCreateFunc)try{return(execFunc=eval("(function() {return "+this.afterCreateFunc+"})()"))(this._id,this.config._name,this)}catch(error){return err=error,sdk.noop()}},NormalBubble.prototype._ifViewExist=function(t){return this.view?t():setTimeout(function(e){return function(){if(e.view)return t()}}(this),1)},NormalBubble.prototype.setDragAreaEx=function(t,e,i,n,o){return this._ifViewExist(function(s){return function(){return o=o||function(){var t;if(sdk.noop(),t=1,1===Math.ceil(Math.random()/t))return sdk.service.info.sendStatistics({action:"window_dragged",probability:t,bubbleId:s._id})},s.view.setDragAreaEx(t,e,i,n,o)}}(this))},NormalBubble.prototype.setBubbleMsgId=function(t){return null==t&&(t=null),"feature"===this.config.purpose&&(t=window.constant.FEATURE_WINDOW_PREFIX),this._ifViewExist(function(e){return function(){return e.view.setBubbleMsgId(e.getMsgGroupName(),t)}}(this))},NormalBubble.prototype.setBubbleTitle=function(t){return this._ifViewExist(function(e){return function(){return e.view.setBubbleTitle(t)}}(this))},NormalBubble.prototype.enableWindowProtection=function(t,e){return this._ifViewExist(function(i){return function(){return i.view.enableWindowProtection(t,e)}}(this))},NormalBubble.prototype.enableWindowProtection2=function(){return this._ifViewExist(function(t){return function(){return t.view.enableWindowProtection2(function(e){var i;if(sdk.noop(),i=.1,1===Math.ceil(Math.random()/i))return sdk.util.justSend("http://pcfg.wps.cn:9002/report/window_capped/"+t._id+"/"+i+"/"+e)})}}(this))},NormalBubble.prototype.enableWindowProtection3=function(){return this._ifViewExist(function(t){return function(){return t.view.enableWindowProtection3()}}(this))},NormalBubble.prototype.setWindowShieldCallback=function(t){return this._ifViewExist(function(e){return function(){var i;return i=0,t=t||function(t){var n;if(i++,sdk.noop(),n=.1,1===Math.ceil(Math.random()/n)&&(sdk.util.justSend("http://pcfg.wps.cn:9002/config/info/window-shield/"+e._id+"/"+n+"/"+sdk.service.info.getUserAsInfo()),sdk.service.info.sendStatistics({action:"window-shield",probability:n,bubbleId:e._id,as:sdk.service.info.getUserAsInfo()})),i>2)return e.close(constant.TYPE_CLOSE_BY_AS_HIDDEN)},e.view.setWindowShieldCallback(t)}}(this))},NormalBubble.prototype.enableWindowProtectionNotify=function(){return this._ifViewExist(function(t){return function(){var e;return e=e||function(e){var i;if(sdk.noop(),i=1,1===Math.ceil(Math.random()/i))return sdk.util.justSend("http://pcfg.wps.cn:9002/config/info/add-hat/"+t._id+"/"+i+"/"+sdk.service.info.getUserAsInfo()),sdk.service.info.sendStatistics({action:"add-hat",probability:i,bubbleId:t._id,as:sdk.service.info.getUserAsInfo()})},t.view.enableWindowProtectionNotify(e)}}(this))},NormalBubble.prototype.enableWindowHoverProtection=function(t){return this._ifViewExist(function(e){return function(){return t=t||function(){var t;if(sdk.noop(),e.close(constant.TYPE_CLOSE_BY_TRY_CLICK_HAT),t=1,1===Math.ceil(Math.random()/t))return sdk.util.justSend("http://pcfg.wps.cn:9002/config/info/try-click-hat/"+e._id+"/"+t+"/"+sdk.service.info.getUserAsInfo()),sdk.service.info.sendStatistics({action:"try-click-hat",bubbleId:e._id,probability:t,as:sdk.service.info.getUserAsInfo()})},e.view.enableWindowHoverProtection(t)}}(this))},NormalBubble.prototype.enableWindowHoverProtection2=function(t){return this._ifViewExist(function(e){return function(){return t=t||function(){var t;if(sdk.noop(),e.close(constant.TYPE_CLOSE_BY_TRY_CLICK_HAT),t=1,1===Math.ceil(Math.random()/t))return sdk.util.justSend("http://pcfg.wps.cn:9002/config/info/try-click-hat/"+e._id+"/"+t+"/"+sdk.service.info.getUserAsInfo()),sdk.service.info.sendStatistics({action:"try-click-hat",bubbleId:e._id,probability:t,as:sdk.service.info.getUserAsInfo()})},e.view.enableWindowHoverProtection2(t)}}(this))},NormalBubble.prototype.enableAutoActiveBubble=function(t){var e,i;return null==t&&(t=10),i=0,e=function(t){return function(){var e;if(!t.view.isBubbleActive())if(sdk.noop(),i<5){if(t.view.activeBubble(),i++,e=.1,1===Math.ceil(Math.random()/e))return sdk.util.justSend("http://pcfg.wps.cn:9002/config/info/active-bubble/"+t._id+"/"+e+"/"+i),sdk.service.info.sendStatistics({action:"active-bubble",bubbleId:t._id,probability:e,num:i})}else if(t.autoActiveToken)return clearInterval(t.autoActiveToken),t.autoActiveToken=null}}(this),this._ifViewExist(function(i){return function(){return i.autoActiveToken=setInterval(function(){return e()},1e3*t)}}(this))},NormalBubble.prototype.close=function(t){return sdk.noop(),t!==constant.TYPE_CLOSE_BY_NORMAL_CLICK_EVENT&&t!==constant.TYPE_CLOSE_BY_RETRY&&sdk.service.info.close(this._id,this.config._name,this.view.getAliveTime(),t,this.getMsgGroupName()),this.view.destroy(),this.alive=!1,sdk.tools.storage.set(constant.STORAGE_KEY_BUBBLE_DATE_CLOSE,sdk.util.getNow()-0,this.storageKeyGroup),sdk.tools.storage.set(constant.STORAGE_KEY_BUBBLE_CLOSE_TYPE,t,this.storageKeyGroup),this.observer.fire("close"),t!==constant.TYPE_CLOSE_BY_RETRY&&this.showTimeout&&clearTimeout(this.showTimeout),this.destroy()},NormalBubble.prototype.destroy=function(){if(NormalBubble.__super__.destroy.apply(this,arguments),this.showToken&&sdk.tools.observer.clean(this.showToken),this.hertbeatToken&&sdk.tools.observer.clean(this.hertbeatToken),this.closeToken&&sdk.tools.observer.clean(this.closeToken),this.autoActiveToken)return clearInterval(this.autoActiveToken),this.autoActiveToken=null},NormalBubble}(BubbleBase),window.NormalBubble=NormalBubble}).call(this);
(function(){var CustomBubble,extend=function(e,t){function r(){this.constructor=e}for(var u in t)hasProp.call(t,u)&&(e[u]=t[u]);return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty;CustomBubble=function(superClass){function CustomBubble(e){CustomBubble.__super__.constructor.call(this,e)}return extend(CustomBubble,superClass),CustomBubble.prototype.exec=function(){var bubbleId,bubbleName,err,error,jsStr;CustomBubble.__super__.exec.apply(this,arguments),this.recordPopup(),bubbleId=this._id,bubbleName=this.config._name;try{jsStr="("+this.script+")('"+bubbleId+"','"+bubbleName+"')",eval(jsStr)}catch(error){err=error,sdk.noop()}finally{this.destroy()}return sdk.service.info.popup(bubbleId,bubbleName,null,this.getMsgGroupName(),!0)},CustomBubble}(BubbleBase),window.CustomBubble=CustomBubble}).call(this);
(function(){var MaterialBubble,extend=function(t,e){function r(){this.constructor=t}for(var i in e)hasProp.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},hasProp={}.hasOwnProperty;MaterialBubble=function(superClass){function MaterialBubble(){return MaterialBubble.__super__.constructor.apply(this,arguments)}return extend(MaterialBubble,superClass),MaterialBubble.prototype.isValid=function(){return!!MaterialBubble.__super__.isValid.call(this)&&(!!sdk.bubble.ifCurrentMsgInfoMatchMaterial(this._id)||(sdk.noop(),!1))},MaterialBubble.prototype.tryExec=function(t){return sdk.util.generateAesKey()instanceof Error?this.mtrV2(function(e){return function(r){return r?MaterialBubble.__super__.tryExec.call(e,t):t(!1)}}(this)):this.mtrV3(function(e){return function(r){return r?MaterialBubble.__super__.tryExec.call(e,t):t(!1)}}(this))},MaterialBubble.prototype.mtrV2=function(t){var e,r,i,s,n,a;if(a=sdk.bubble.getAllMatchTitles(this.getMsgGroupInfo(),sdk.bubble.getMaterialTagsFromIni(this._id)),!a)return t&&t(!1);a=a.substr(0,116),sdk.noop();try{s=new Date,n=sdk.util.rsaEncrypt(a),s=new Date-s,sdk.noop(),sdk.service.info.sendStatistics({action:"rsaEncrypt",probability:.01,value:1,len:Math.ceil(a.length/10),time:Math.ceil(s/10)})}catch(i){return r=i,sdk.noop(),sdk.service.info.sendStatistics({action:"rsaEncrypt",probability:.01,value:0,len:Math.ceil(a.length/10)}),t&&t(!1)}return e=sdk.util.decodeBase64(sdk.tools.storage.get("city")||""),sdk.util.ajax({url:"http://pcfg.wps.cn:9002/mtr/bs_v2",data:{hdid:sdk.client.info.getHdid()||"",title:encodeURIComponent(n),as:sdk.as.getAsProcess("id",";"),city:sdk.util.aesEncrypt(e)||e,bubble_id:this._id},type:"get",timeout:10,success:function(e){return function(r){return e.mtrReqSuc(r,t)}}(this),error:function(e){return this.mtrReqErr(e,t)}})},MaterialBubble.prototype.mtrV3=function(t){var e,r,i,s,n,a,o;if(a=sdk.util.generateAesKey(),o=sdk.bubble.getAllMatchTitles(this.getMsgGroupInfo(),sdk.bubble.getMaterialTagsFromIni(this._id)),!o)return t&&t(!1);sdk.noop();try{e=new Date,r=sdk.util.aesEncryptEx(a,o),a=sdk.util.rsaEncrypt(a),e=new Date-e,sdk.noop(),sdk.noop(),sdk.service.info.sendStatistics({action:"aesEncrypt",probability:.01,value:1,len:Math.ceil(o.length/10),time:Math.ceil(e/10)})}catch(n){return s=n,sdk.noop(),sdk.service.info.sendStatistics({action:"aesEncrypt",probability:.01,value:0,len:Math.ceil(o.length/10)}),t&&t(!1)}return i=sdk.util.decodeBase64(sdk.tools.storage.get("city")||""),sdk.util.ajax({url:"http://pcfg.wps.cn:9002/mtr/bs_v3",data:{hdid:sdk.client.info.getHdid()||"",title:encodeURIComponent(r),key:encodeURIComponent(a),as:sdk.as.getAsProcess("id",";"),city:sdk.util.aesEncrypt(i)||i,bubble_id:this._id},type:"get",timeout:10,success:function(e){return function(r){return e.mtrReqSuc(r,t)}}(this),error:function(e){return this.mtrReqErr(e,t)}})},MaterialBubble.prototype.mtrReqSuc=function(ret,cb){var err,error,mtr;if(sdk.noop(),!this.popupIntervalCheck())return cb&&cb(!1);try{if(mtr=eval("("+ret+")"),this.materialConfig=mtr.data,this.materialConfig)return this.materialConfig.info.substance_group&&this.materialConfig.info.substance_interval&&(this.substanceMutex=!0,!sdk.bubble.checkSubstanceMutex(this.materialConfig.info.substance_group,this.materialConfig.info.substance_interval))?cb&&cb(!1):cb&&cb(!0)}catch(error){err=error,sdk.noop()}return sdk.bubble.addMaterialFailedNum(),cb&&cb(!1)},MaterialBubble.prototype.mtrReqErr=function(t,e){return sdk.noop(),sdk.bubble.addMaterialFailedNum(),e&&e(!1)},MaterialBubble.prototype.parseContentConfig=function(){var t,e,r,i,s,n,a,o,l,u,c;if(n=0,o=0,c="",r="",l="",t=null,u=this.materialConfig.info?this.materialConfig.info.frame_url||[]:[],u.length>1){e=parseInt(sdk.client.info.getHdid().substr(0,2),16)%u.length;try{t=u[e].match(/([a-zA-Z0-9]{32})/)[1]}catch(b){t=""}l=sdk.util.createGetUrl(u[e],{bubble_testId:t})}else 1===u.length&&(l=u[0]);return l=sdk.util.createGetUrl(l,{bubble_msg:this.getMsgGroupName()}),a=sdk.util.getUrlParam("bubble_wh",l),a&&(i=a.indexOf("_"))>-1&&(c=a.substr(0,i),r=a.substr(i+1)),i=c.indexOf("~"),i>-1&&(n=c.substr(i+1),c=c.substr(0,i)),i=r.indexOf("~"),i>-1&&(o=r.substr(i+1),r=r.substr(0,i)),sdk.noop(),sdk.noop(),s={materialId:this.materialConfig._id,materialName:this.materialConfig.name,keyword:this.materialConfig.k_h?sdk.util.aesDecrypt(this.materialConfig.k_h):void 0,isAd:this.config.is_ad,traceProbability:this.config.trace_probability,substanceGroup:this.materialConfig.info.substance_group||this.config._substance_group},t&&(s.abTestId=t),this.setBubbleInfo(s),{width:c,height:r,url:l,bubbleTestId:t,leftMargin:n,topMargin:o}},MaterialBubble}(NormalBubble),window.MaterialBubble=MaterialBubble}).call(this);
(function(){var t,n,o=function(t,n){function o(){this.constructor=t}for(var i in n)e.call(n,i)&&(t[i]=n[i]);return o.prototype=n.prototype,t.prototype=new o,t.__super__=n.prototype,t},e={}.hasOwnProperty,i=[].slice;n={PLUGIN_NAME:"mdsmnst",ACTION_POPUP:1,ACTION_CLOSE:6,RESULT_FAIl:0,RESULT_TIMEOUT:2},t=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.isValid=function(){return!/00020\.00002578|00020\.00002579|00020\.00002642/.test(sdk.client.info.getDistNum())||(sdk.noop(),!1)},e.prototype.tryExec=function(t){var o,e,i;return o=this._id,e=sdk.tools.observer.on(o+"_show",function(i){return function(r){var s;return r||(sdk.util.justSend("http://pcfg.wps.cn:9002/config/info/error/"+o+"/1/no_popup_type"),r=1),s=4*(i.view.id-0)+r,i.notifyPlugin(n.ACTION_POPUP,s),i._ifViewExist(function(){return i.view.move(-3e4,-3e4)}),sdk.tools.observer.clean(e),t&&t(!0)}}(this)),i=sdk.tools.observer.on(o+"_stop",function(o){return function(){return o.notifyPlugin(n.ACTION_POPUP,n.RESULT_FAIl),o.close(window.constant.TYPE_CLOSE_BY_WEBVIEW_STOP),o._rollbackGlobalLastExecDate(),sdk.tools.observer.clean(i),t&&t(!1)}}(this)),this.exec()},e.prototype.close=function(t){return t!==window.constant.TYPE_CLOSE_BY_TIMEOUT&&t!==window.constant.TYPE_CLOSE_BY_FORCE||this.notifyPlugin(n.ACTION_CLOSE),t===window.constant.TYPE_CLOSE_BY_RETRY&&this.notifyPlugin(n.ACTION_POPUP,n.REQUEST_TIME_OUT),e.__super__.close.call(this,t)},e.prototype.notifyPlugin=function(){var t,o;return t=1<=arguments.length?i.call(arguments,0):[],(o=sdk.client.webview).notifyPopupResult.apply(o,[n.PLUGIN_NAME].concat(i.call(t)))},e.prototype.setBubbleMsgId=function(t){return null==t&&(t=null),this._ifViewExist(function(n){return function(){return n.view.setBubbleMsgId(n.getMsgGroupName(),t)}}(this))},e}(NormalBubble),window.MinisiteBubble=t}).call(this);
(function(){var MsgBubble,appName,extend=function(e,t){function s(){this.constructor=e}for(var r in t)hasProp.call(t,r)&&(e[r]=t[r]);return s.prototype=t.prototype,e.prototype=new s,e.__super__=t.prototype,e},hasProp={}.hasOwnProperty,slice=[].slice;appName=sdk.client.info.getAppName(),MsgBubble=function(superClass){function MsgBubble(e){MsgBubble.__super__.constructor.call(this,{}),this.config._id=e,this.config._name=this.config._id,this.config.url=e}return extend(MsgBubble,superClass),MsgBubble.prototype.isValid=function(){return!sdk.system.isProjectorConnected()||(sdk.noop(),!1)},MsgBubble.prototype.isReady=function(){return!!this.ready},MsgBubble.prototype.isLoaded=function(){return!!this.loaded},MsgBubble.prototype.sendMessage=function(){var e,t,s,r;return e=1<=arguments.length?slice.call(arguments,0):[],this.connected?(r=e.shift(),t=sdk.util.encodeBase64(sdk.util.serialize(e)),s='sdk.tools.observer.fire("'+r+'", "'+t+'")',sdk.client.webview.execute(this.view.id,s),sdk.noop()):setTimeout(function(t){return function(){return t.sendMessage.apply(t,e)}}(this),1e3)},MsgBubble.prototype.exec=function(){var bubbleId,bubbleName,closeTimeout,closeWhenClick,domainList,handlerDestroy,handlerLinkClicked,handlerLoaded,height,serverTopview,url,width;return MsgBubble.__super__.exec.apply(this,arguments),this.recordPopup(),bubbleId=this.config._id,bubbleName=this.config._name,url=this.config.url,width=800,height=600,closeTimeout=864e5,closeWhenClick=!1,handlerDestroy=sdk.noop,handlerLoaded=function(e){return function(){return e.loaded=!0}}(this),handlerLinkClicked=sdk.noop,domainList=[],this.view=sdk.client.webview.generateRightBottomBubble(width,height,url,bubbleId,bubbleName,closeWhenClick,closeTimeout,handlerDestroy,handlerLoaded,handlerLinkClicked,domainList),this.channelView="view_"+this.view.id,serverTopview="bubble_service",this.setBubbleMsgId(),sdk.tools.observer.on(bubbleId+"_heartbeat",function(e){return function(){var t;return t=setInterval(function(){var s;if(s=new Date,e.alive&&e.visible&&s-e.lastBeat>1e4)return view.destroy(constant.TYPE_CLOSE_BY_FORCE,!1),sdk.util.justSend("http://pcfg.wps.cn:9002/report/error/forceClosed/"+bubbleId+"/"+bubbleName+"/"+appName+"/"+e.retryNum),clearInterval(t)},5e3),function(){return e.lastBeat=new Date}}}(this)()),sdk.tools.observer.on(""+this.channelView,function(_this){return function(argsb64){var action,args,b64,err,error,error1,params,server;try{args=eval("("+sdk.util.decodeBase64(argsb64)+")")}catch(error){err=error,args=[],sdk.noop()}if(server=args.shift()){if(server!==serverTopview)return params={url:_this.config.url,server:server,message:args[0]},b64=sdk.util.encodeBase64(sdk.util.serialize(params)),sdk.client.plugin.emit(server,b64),sdk.noop();try{return action=args.shift(),"show"===action?(_this.visible=!0,_this.view.show(),sdk.service.info.popup(bubbleId,bubbleName),sdk.tools.storage.set(constant.STORAGE_KEY_BUBBLE_DATE_POPUP,sdk.util.getNow()-0,_this.storageKeyGroup)):"destroy"===action?_this.close():"hide"===action?(_this.visible=!1,_this.view.hide()):"move"===action?_this.view.move.apply(_this.view,args):"resize"===action?_this.view.resize.apply(_this.view,args):"setOpacity"===action?_this.view.setOpacity.apply(_this.view,args):"setZOrder"===action?_this.view.setZOrder.apply(_this.view,args):"connected"===action&&(_this.connected=!0),sdk.noop()}catch(error1){return err=error1,sdk.noop()}}}}(this)),sdk.tools.observer.on("window_close",function(e){return function(t,s){return null==s&&(s=2),sdk.noop(),s===constant.TYPE_CLOSE_BY_FORCE?(e.close(s),void sdk.noop()):view.id===t||bubbleId===t?e.close(s):void 0}}(this))},MsgBubble.prototype.setBubbleMsgId=function(e){return null==e&&(e=window.constant.FEATURE_WINDOW_PREFIX),this.view.setBubbleMsgId(this.getMsgGroupName(),e)},MsgBubble.prototype.close=function(e){return sdk.noop(),this.view.destroy(),sdk.tools.storage.set(constant.STORAGE_KEY_BUBBLE_DATE_CLOSE,sdk.util.getNow()-0,this.storageKeyGroup),this.observer.fire("close"),this.destroy()},MsgBubble}(BubbleBase),window.MsgBubble=MsgBubble}).call(this);
(function(){var appName,cleanIniInterval,configLoadPath,configService,keyCityBase64,keyConfigList,keyConfigListBase64,keyConfigListLength,keyTimeLastCleanConfig,keyTimeLastLoadCity,keyTimeLastLoadConfig,loadCityInterval,loadConfigInterval,storage;keyTimeLastLoadCity="time_last_load_city",keyCityBase64="city",keyTimeLastLoadConfig="time_last_load_config",keyTimeLastCleanConfig="time_last_clean_config",keyConfigListBase64="config_list",loadCityInterval=6048e5,loadConfigInterval=36e5,cleanIniInterval=24*Math.floor(7*Math.random()+3)*36e5,keyConfigList="config",keyConfigListLength="config_len",appName=sdk.client.info.getAppName(),storage=sdk.tools.storage,configLoadPath={"":"/config/pc/list","1.0":"/config/pc/list_v2"},configService={getConfigList:function(t){var e,r;return 1===window.service.getPluginLoadNumToday()&&(r=sdk.util.getNow(),e=this._getLastCleanTime()-0,r-e>cleanIniInterval&&this.clearLocalStorageData()),this._getConfigList(t)},clearLocalStorageData:function(){return this._setConfigToIni(sdk.util.encodeBase64("")),this._setLastCleanTime(),this._setLastLoadTime(0)},_ifLocalConfigExpires:function(t){var e;return e=this._getLastLoadTime()-0,sdk.util.ajax({url:"//switch.pcfg.cache.wpscdn.cn/platform_lmt/pc",type:"get",timeout:10,success:function(r){return r-=0,sdk.noop(),t(e<r)},error:function(e){return sdk.noop(),t(!0)}})},_getConfigFromService:function(t){return this._getCity(function(e){return function(r){return e._getConfigByCity(r,function(r,o){var n,i,a,s,l,c,u,d,p,f;for(r=r||[],d=[],p=e._getConfigFromIni(),f={},s=0,c=p.length;s<c;s++)i=p[s],f[i._id]=i;for(a=l=0,u=r.length;l<u;a=++l)i=r[a],n=i._id,i._last_modify_time?d.push(i):f[n]?d.push(f[n]):sdk.noop();return r=e._bubbleConfigSort(d),sdk.noop(),sdk.util.setNow(o||sdk.util.getNow()),e._setLastLoadTime(),e._setConfigToIni(sdk.util.encodeBase64(sdk.util.serialize(r))),t(r)})}}(this))},_getConfigList:function(t){var e,r;return config.enable?(r=sdk.util.getNow(),e=this._getLastLoadTime()-0,r-e<loadConfigInterval?(sdk.noop(),t(this._getConfigFromIni())):this._ifLocalConfigExpires(function(e){return function(r){return r?(sdk.noop(),e._getConfigFromService(t)):(sdk.noop(),t(e._getConfigFromIni()))}}(this))):(sdk.noop(),t([]))},_getCity:function(t){var e,r,o;return o=sdk.util.getNow(),r=sdk.tools.storage.get(keyTimeLastLoadCity),r=r?new Date(r-0):0,o-r<loadCityInterval&&(sdk.noop(),e=this._getCityFromIni())?t(e):(sdk.noop(),this._getCityFromTb(function(e){return function(r){return Math.random()<.001&&sdk.util.justSend("http://pcfg.wps.cn:9002/report/city_online/"+!!r),r||(r=e._getCityFromIni()),sdk.tools.storage.set(keyCityBase64,sdk.util.encodeBase64(r)),sdk.system.setReg("city",sdk.util.encodeBase64(r),"HKEY_CURRENT_USER\\Software\\kingsoft\\Office\\6.0\\plugins\\kbubble"),t(r)}}(this)))},_getCityFromIni:function(){var t;return t=sdk.tools.storage.get(keyCityBase64)||"",sdk.util.decodeBase64(t)},_getCityFromSina:function(cb){return sdk.noop(),sdk.util.httpGet("http://int.dpool.sina.com.cn/iplookup/iplookup.php?format=json",{},function(_this){return function(str){var area,city,err,error1;sdk.noop();try{area=eval("("+str+")"),city=area.city,sdk.tools.storage.set(keyCityBase64,sdk.util.encodeBase64(city)),sdk.tools.storage.set(keyTimeLastLoadCity,sdk.util.getNow()-0)}catch(error1){err=error1,city=null}return cb&&cb(city)}}(this),function(t){return function(t){return sdk.noop(),cb&&cb("")}}(this))},_getCityFromTb:function(cb){return sdk.noop(),sdk.util.httpPost("http://ip.taobao.com/service/getIpInfo2.php",{ip:"myip"},function(_this){return function(str){var area,city,err,error1;sdk.noop();try{area=eval("("+str+")"),city=area.data.city,sdk.tools.storage.set(keyCityBase64,sdk.util.encodeBase64(city)),sdk.tools.storage.set(keyTimeLastLoadCity,sdk.util.getNow()-0)}catch(error1){err=error1,city=null}return cb&&cb(city)}}(this),function(t){return function(t){return sdk.noop(),cb&&cb("")}}(this))},_getLastLoadTime:function(){return storage.get(keyTimeLastLoadConfig,appName)},_setLastLoadTime:function(t){return null==t&&(t=sdk.util.getNow()),sdk.tools.storage.set(keyTimeLastLoadConfig,t-0,appName)},_getLastCleanTime:function(){return storage.get(keyTimeLastCleanConfig,appName)},_setLastCleanTime:function(t){return null==t&&(t=sdk.util.getNow()),sdk.tools.storage.set(keyTimeLastCleanConfig,t-0,appName)},_setConfigToIni:function(t){var e;return e=sdk.util.writeBubbleConfig(t),e instanceof Error&&"not support"===e.message?(sdk.noop(),"ruby"===sdk.platform?this._setConfigToIniForRuby(t):this._setConfigToIniForCpp(t)):e},_setConfigToIniForCpp:function(t){var e,r,o,n,i,a,s,l,c,u;for(u="!@#$",t=t.replace(/.{250}/g,function(t){return t+u}),e=t.split(u),a=e.length,l=storage.get(keyConfigListLength,appName)||0,r=n=0,c=l;0<=c?n<c:n>c;r=0<=c?++n:--n)storage.set(keyConfigList+r,"",appName);for(r=i=0,s=e.length;i<s;r=++i)o=e[r],storage.set(keyConfigList+r,o,appName);return storage.set(keyConfigListLength,a,appName)},_setConfigToIniForRuby:function(t){return storage.set(keyConfigList,t,appName)},_getConfigFromIni:function(){var err,error1,list,result;try{result=sdk.util.readBubbleConfig(),result instanceof Error&&"not support"===result.message?(sdk.noop(),list="ruby"===sdk.platform?this._getConfigFromIniForRuby():this._getConfigFromIniForCpp()):list=result,list=sdk.util.decodeBase64(list),list=""===list?[]:eval("("+list+")"),this._reportIfParseSuccess(!0,null)}catch(error1){err=error1,sdk.noop(),this._setConfigToIni(sdk.util.encodeBase64("")),this._setConfigToIni(""),list=[],this._reportIfParseSuccess(!1,err)}return list},_getConfigFromIniForCpp:function(){var t,e,r,o,n;for(o="",r=storage.get(keyConfigListLength,appName)-0||0,t=e=0,n=r;0<=n?e<n:e>n;t=0<=n?++e:--e)o+=storage.get(keyConfigList+t,appName);return o},_getConfigFromIniForRuby:function(){return storage.get(keyConfigList,appName)},_reportIfParseSuccess:function(t,e){var r,o,n,i,a,s,l,c;if(null==e&&(e=null),s="production"===sdk.env?.001:1,Math.random()>s)return!1;if(l=t?"success":"fail",e)try{a=e.message.slice(0,10)}catch(o){r=o,a="unknown_error"}else a="0";return n=window.service,i=n.getPluginLoadNumToday()||1,appName=n.appName,c="http://pcfg.wps.cn:9002/report/ini_parse/"+appName+"/"+l+"/"+a+"/"+i,sdk.noop(),sdk.util.justSend(c)},_reportIfLoadSuccess:function(t,e,r){var o,n,i,a,s,l,c;if(null==r&&(r=null),a="production"===sdk.env&&"v4_2"!==e?.01:1,Math.random()>a)return!1;if(s=t?"success":"fail",r)try{i=r.message.slice(0,10)}catch(n){o=n,i="unknown_error"}else i="0";return appName=sdk.client.info.getAppName(),c=e||sdk.util.getRsaVersion()||"0",l="http://pcfg.wps.cn:9002/report/cfg_list_"+c+"/"+appName+"/"+s+"/"+i,sdk.noop(),sdk.util.justSend(l)},_getAntivirusSoftware:function(){var t;return t=sdk.as.getAsInstall("name"),t.length&&sdk.noop(),sdk.as.getAsInstall("id",",")},_getConfigByCity:function(city,cb){var config,j,k,len1,list,localModify,param,v,validLocalModify;for(list=this._getConfigFromIni()||"",localModify={},j=0,len1=list.length;j<len1;j++)config=list[j],localModify[config._id]=config._last_modify_time-0;param={_hdid:sdk.client.info.getHdid(),_city:sdk.util.aesEncrypt(city)||city,_dist:sdk.client.info.getDistNum(),_client_name:sdk.client.info.getAppName(),_client_version:sdk.client.info.getAppVersion(),_os_name:sdk.system.getOsName(),_as:this._getAntivirusSoftware(),_t:sdk.util.getNow()-0},validLocalModify=!1;for(k in localModify)v=localModify[k],v?validLocalModify=!0:delete localModify[k];return validLocalModify&&(param._last_load_time=this._getLastLoadTime(),param._local_modify=sdk.util.serialize(localModify)),sdk.util.ajax({url:"//img1.pcfg.cache.wpscdn.cn/ddm/pc",type:"get",timeout:10,success:function(_this){return function(ret){var domain,err,error1,info,protocol,urlLoadConfig;try{if(info=eval("("+ret+")"),domain=info.domain,protocol=info.protocol,!domain)throw new Error("地址为空");return urlLoadConfig=protocol+"//"+domain,sdk.noop(),"1.0"===sdk.util.getRsaVersion()?_this._loadConfigV4(urlLoadConfig,param,function(t,e,r){return null==r&&(r=null),_this._reportIfLoadSuccess(!!t.length,"v4",r),t.length?cb(t,e):(sdk.noop(),_this._loadConfigV4(urlLoadConfig,param,function(t,e,r){return null==r&&(r=null),_this._reportIfLoadSuccess(!!t.length,"v4_2",r),cb(t,e)}))}):_this._loadConfig(urlLoadConfig,param,function(t,e){return _this._reportIfLoadSuccess(!!t.length),cb(t,e)})}catch(error1){return err=error1,sdk.noop(),cb([],null)}}}(this),error:function(){return cb([],null)}})},_loadConfig:function(host,param,cb){var err,error1,k,key,params,path,rsa,url,v;try{rsa=sdk.util.getRsaVersion(),path=configLoadPath[rsa],key=sdk.util.getRsaSK(),params=[];for(k in param)v=param[k],"ruby"!==sdk.platform&&(v=encodeURIComponent(v)),v&&params.push(k+"="+v);return url=host+path,params.length>0&&(url+="?"+params.join("&")),sdk.util.ajax({url:url,type:"get",timeout:10,success:function(ret){var _data,aesKey,data,err,error1,error2,i,item,j,len1,str;sdk.noop();try{ret=eval("("+ret+")")}catch(error1){return err=error1,sdk.noop(),cb([],null)}if(data=ret.data,!rsa)return cb(data||[],ret.timestamp);if(aesKey=ret.status,aesKey=sdk.util._rsaDecrypt(key,aesKey),!aesKey)return sdk.noop(),cb([],ret.timestamp);for(_data=[],i=j=0,len1=data.length;j<len1;i=++j)if(item=data[i],"string"==typeof item){str=sdk.util.aesDecryptEx(aesKey,item);try{_data[i]=eval("("+str+")")}catch(error2){err=error2,sdk.noop()}}else _data[i]=item;return cb(_data,ret.timestamp)},error:function(t){return sdk.noop(),cb([],null)}})}catch(error1){return err=error1,sdk.noop()}},_loadConfigV3:function(host,param,cb){var err,error1,k,key,params,path,url,v,version;try{version="v3",path="/config/pc/list_v3",key=sdk.util.getRsaSK(),params=[];for(k in param)v=param[k],"ruby"!==sdk.platform&&(v=encodeURIComponent(v)),v&&params.push(k+"="+v);return url=host+path,params.length>0&&(url+="?"+params.join("&")),sdk.util.ajax({url:url,type:"get",timeout:10,success:function(ret){var _data,data,err,error1,error2,i,item,j,len1,oMap,str;sdk.noop();try{ret=eval("("+ret+")")}catch(error1){return err=error1,sdk.noop(),cb([],null)}if(data=ret.data,oMap=ret.status,oMap=sdk.util._rsaDecrypt(key,oMap),!oMap)return sdk.noop(),cb([],ret.timestamp);for(oMap=sdk.util.obfuscate.str2Map(oMap),_data=[],i=j=0,len1=data.length;j<len1;i=++j)if(item=data[i],"string"==typeof item){str=sdk.util.obfuscate.decryptBase64(item,oMap),str=sdk.util.decodeBase64(str);try{_data[i]=eval("("+str+")")}catch(error2){err=error2,sdk.noop()}}else _data[i]=item;return cb(_data,ret.timestamp)},error:function(t){return sdk.noop(),cb([],null)}})}catch(error1){return err=error1,sdk.noop()}},_loadConfigV4:function(host,param,cb){var err,error1,getAllCfg,getAllId,key,path,version;try{return version="v4",path="/config/pc/list_v4",key=sdk.util.getRsaSK(),getAllCfg=function(callback){return sdk.util.ajax({url:"//cfg.pcfg.cache.wpscdn.cn/config/pc/list_all",type:"get",timeout:10,success:function(ret){var _data,data,err,error1,error2,i,item,j,len1,oMap,str;try{ret=eval("("+ret+")")}catch(error1){return err=error1,sdk.noop(),callback&&callback([])}if(data=ret.data,oMap=ret.status,oMap=sdk.util._rsaDecrypt(key,oMap),!oMap)return sdk.noop(),cb([],ret.timestamp);for(oMap=sdk.util.obfuscate.str2Map(oMap),_data=[],i=j=0,len1=data.length;j<len1;i=++j)if(item=data[i],"string"==typeof item){str=sdk.util.obfuscate.decryptBase64(item,oMap),str=sdk.util.decodeBase64(str);try{_data[i]=eval("("+str+")")}catch(error2){err=error2,sdk.noop()}}else _data[i]=item;return sdk.noop(),callback&&callback(_data)},error:function(t){return sdk.noop(),callback&&callback([])}})},getAllId=function(callback){var k,params,url,v;params=[];for(k in param)v=param[k],"ruby"!==sdk.platform&&(v=encodeURIComponent(v)),v&&params.push(k+"="+v);return url=host+path,params.length>0&&(url+="?"+params.join("&")),sdk.util.ajax({url:url,type:"get",timeout:10,success:function(ret){var err,error1;sdk.noop();try{ret=eval("("+ret+")")}catch(error1){return err=error1,sdk.noop(),callback([],null)}return callback(ret.data||[],ret.timestamp)},error:function(t){return sdk.noop(),callback([],null)}})},getAllCfg(function(t){return t&&t.length?getAllId(function(e,r){var o,n,i,a,s,l,c,u;if(!e||!e.length)return sdk.noop(),cb([],null,new Error("no_id_list"));for(c={},i=0,s=e.length;i<s;i++)u=e[i],c[u._id]=1;for(o=[],a=0,l=t.length;a<l;a++)n=t[a],1===c[n._id]&&o.push(n);return cb(o,r)}):(sdk.noop(),cb([],null,new Error("no_cfg")))})}catch(error1){return err=error1,sdk.noop()}},_bubbleConfigSort:function(t){return t instanceof Array||(t=[]),t.sort(function(t,e){return e._priority-t._priority}),t}},window.configService=configService}).call(this);
(function(){var Agent;Agent=function(){function Agent(t){this.onLoaded=null!=t?t:sdk.noop,this.classMap={normal_bubble:NormalBubble,custom_bubble:CustomBubble,material_bubble:MaterialBubble,minisite_bubble:MinisiteBubble},this.observer=new sdk["class"].Observer,this.channelBubbleClose="bubble_close",this.channelConfigListDownload="bubble_download",this.channelInterval="bubble_interval",this.observer.on([this.channelBubbleClose,this.channelConfigListDownload,this.channelInterval],function(t){return function(){return sdk.noop(),t.hasEffectBubble()?void sdk.noop():sdk.client.plugin.exit(config.process_exit_timeout,"没有可执行的气泡配置")}}(this)),sdk.tools.observer.on("window_close",function(t){return function(o){var e,s,i,n,r;for(sdk.noop(),n=!0,r=t.getHealthyBubble(),s=0,i=r.length;s<i;s++)e=r[s],e&&e.substanceMutex&&e.view.id!==o&&(sdk.noop(),n=!1);return n&&sdk.bubble.kbStatusToReg("close")}}(this)),sdk.bubble.kbStatusToReg("close")}return Agent.prototype.start=function(){return sdk.util.iniCache.clear(),this.pushNotifyToDb(),configService.getConfigList(function(t){return function(o){var e,s,i,n,r;for(null==o&&(o=[]),sdk.noop(),Math.random()<=.01&&sdk.util.justSend("http://pcfg.wps.cn:9002/report/cfg_finally/"+sdk.client.info.getAppName()+"/"+(0!==o.length)+"/0"),t.registerProcessMonitor(o),t.intervalBoList=[],t.notifyBoList=[],t.customBoList=[],s=function(o,e){var s,i,n;try{return s=new t.classMap[o._template_type](o),s.observer.on("destroy",function(){return t.observer.fire(t.channelBubbleClose)}),s.notifyGroup.length?(t.notifyBoList.push(s),sdk.noop()):s instanceof CustomBubble?(t.customBoList.push(s),sdk.noop()):s instanceof MinisiteBubble?(t.customBoList.push(s),sdk.noop()):(t.intervalBoList.push(s),sdk.noop())}catch(n){return i=n,sdk.noop()}},n=i=0,r=o.length;i<r;n=++i)e=o[n],s(e,n);return t.observer.fire(t.channelConfigListDownload),setTimeout(function(){if(o.length)return t.startBubbleInterval()},5e3),t.onLoaded&&t.onLoaded()}}(this)),window.config.overlayKilled&&sdk.tools.observer.on("overlayGroupInfo",function(t){return function(o,e){var s,i,n,r,u,l,a;sdk.noop();try{for(i=t.intervalBoList.concat(t.notifyBoList),a=[],u=0,l=i.length;u<l;u++)s=i[u],s.alive&&(s._id!==o&&s.overlayGroup===e&&(s.view&&s.view.valid()||s.executing)?(sdk.noop(),a.push(s.close(window.constant.TYPE_CLOSE_BY_OVERLAY_GROUP))):a.push(void 0));return a}catch(r){return n=r,sdk.noop()}}}(this)),sdk.tools.observer.on("killOthers",function(t){return function(o){var e,s,i,n,r,u,l;sdk.noop();try{for(s=t.intervalBoList.concat(t.notifyBoList),l=[],r=0,u=s.length;r<u;r++)e=s[r],e.alive&&(e._id!==o&&(e.view&&e.view.valid()||e.executing)?(sdk.noop(),l.push(e.close(window.constant.TYPE_CLOSE_BY_OVERLAY_GROUP))):l.push(void 0));return l}catch(n){return i=n,sdk.noop()}}}(this))},Agent.prototype.clearBoList=function(){return this.msgBoList=[],this.intervalBoList=[],this.notifyBoList=[],this.customBoList=[]},Agent.prototype.hasEffectBubble=function(){var t,o,e,s,i,n,r,u,l,a,c,p,b,h,d,f;o=!1,this.msgBoList=this.msgBoList||[],this.intervalBoList=this.intervalBoList||[],this.notifyBoList=this.notifyBoList||[],this.customBoList=this.customBoList||[];try{for(b=this.intervalBoList,i=0,l=b.length;i<l;i++)t=b[i],(t.isAlive()||t.isValid())&&(o=!0,sdk.noop());for(h=this.notifyBoList,n=0,a=h.length;n<a;n++)t=h[n],t.isAlive()&&(o=!0,sdk.noop());for(d=this.msgBoList,r=0,c=d.length;r<c;r++)t=d[r],t.isAlive()&&(o=!0,sdk.noop());for(f=this.customBoList,u=0,p=f.length;u<p;u++)t=f[u],(t.isAlive()||t.isValid())&&(o=!0,sdk.noop())}catch(s){e=s,sdk.noop()}return o},Agent.prototype.hasAliveBubble=function(){var t,o,e,s,i,n;this.msgBoList=this.msgBoList||[],this.intervalBoList=this.intervalBoList||[],this.notifyBoList=this.notifyBoList||[],this.customBoList=this.customBoList||[];try{for(o=this.notifyBoList.concat(this.intervalBoList).concat(this.customBoList).concat(this.msgBoList),sdk.noop(),i=0,n=o.length;i<n;i++)if(t=o[i],t.alive){if(sdk.noop(),t.executing)return sdk.noop(),!0;if(!t.view||t.view.valid()){if(!t.view||t.view.isHealthy())return!0;sdk.noop(),t.close(constant.TYPE_CLOSE_BY_RELOAD)}else sdk.noop()}}catch(s){e=s,sdk.noop()}return!1},Agent.prototype.getAliveBubble=function(){var t,o,e,s,i,n,r;this.msgBoList=this.msgBoList||[],this.intervalBoList=this.intervalBoList||[],this.notifyBoList=this.notifyBoList||[],this.customBoList=this.customBoList||[],t=[];try{for(e=this.notifyBoList.concat(this.intervalBoList).concat(this.customBoList).concat(this.msgBoList),sdk.noop(),n=0,r=e.length;n<r;n++)o=e[n],o.isAlive()&&(sdk.noop(),t.push(o))}catch(i){s=i,sdk.noop()}return t},Agent.prototype.getHealthyBubble=function(){var t,o,e,s,i,n,r;this.intervalBoList=this.intervalBoList||[],this.notifyBoList=this.notifyBoList||[],t=[];try{for(e=this.notifyBoList.concat(this.intervalBoList),sdk.noop(),n=0,r=e.length;n<r;n++)o=e[n],!o.view||o.view.isHealthy()?!o.view||o.view.valid()?o.alive&&(sdk.noop(),t.push(o)):sdk.noop():(sdk.noop(),o.close(constant.TYPE_CLOSE_BY_RELOAD))}catch(i){s=i,sdk.noop()}return t},Agent.prototype.isDisabledPageReload=function(){var t,o,e,s,i,n,r;this.msgBoList=this.msgBoList||[],this.intervalBoList=this.intervalBoList||[],this.notifyBoList=this.notifyBoList||[],this.customBoList=this.customBoList||[],e=!1;try{for(o=this.notifyBoList.concat(this.intervalBoList).concat(this.customBoList).concat(this.msgBoList),sdk.noop(),n=0,r=o.length;n<r;n++)if(t=o[n],t.isAlive()&&t.disabledPageReload){e=!0;break}}catch(i){s=i,sdk.noop()}return e},Agent.prototype.startBubbleInterval=function(){if(!this.test)return sdk.noop(),this.execCustomBubble(0,this.customBoList),this.tryExecNormalBubble(0,this.intervalBoList)},Agent.prototype.execCustomBubble=function(t,o,e,s){var i;return o.length<=t?void sdk.noop():(i=o[t],sdk.noop(),i?i.canPopup(e,s,function(n){return function(r){return r&&i.exec(),n.execCustomBubble(t+1,o,e,s)}}(this)):this.execCustomBubble(t+1,o,e,s))},Agent.prototype.tryExecNormalBubble=function(t,o,e,s,i){var n,r,u,l,a;if(o.length<=t)return sdk.noop(),void sdk.service.info.sendMsgTrace("js_finish_without_popup",i,e,s);if(n=o[t],sdk.noop(),!n)return this.tryExecNormalBubble(t+1,o,e,s,i);try{return a=function(r){return function(){var u;return e&&(u=.01,1===Math.ceil(Math.random()/u)&&sdk.util.justSend("http://pcfg.wps.cn:9002/report/msg/"+e+"/"+u+"/1"),n._backupGlobalLastExecDate()),n.tryExec(function(n){return n?(sdk.noop(),void sdk.service.info.sendMsgTrace("js_finish_with_popup",i,e,s)):(sdk.noop(),r.tryExecNormalBubble(t+1,o,e,s,i))})}}(this),l=function(n){return function(){return sdk.noop(),n.tryExecNormalBubble(t+1,o,e,s,i)}}(this),n.canPopup(e,s,function(t){return function(t){return sdk.noop(),t?a():l()}}(this))}catch(u){r=u}},Agent.prototype.receiveMessage=function(t,o){return/^wps_cmd/.test(t)?this.processCommand(t):/^windows_/.test(t)?this.processWindowMsg(t):/^test_/.test(t)?this.popTestBubble(t):/^wps_msg_push/.test(t)?this.popMsgBubble(t):this.popNotifyBubble(t,o)},Agent.prototype.stop=function(){return sdk.noop(),sdk.tools.observer.fire("window_close",-1,constant.TYPE_CLOSE_BY_MIDNIGHT_RELOAD),sdk.client.plugin.exit(1e4,"退出"),sdk.util.justSend("http://pcfg.wps.cn:9002/report/overnight_reload"),sdk.noop()},Agent.prototype.restart=function(){return sdk.noop(),this.stop(),sdk.noop(),sdk.client.plugin.reload(),setTimeout(function(t){return function(){return sdk.noop(),window.location.reload(!1)}}(this),3e4),sdk.noop()},Agent.prototype.processCommand=function(t){var o,e,s,i,n,r,u,l,a,c;sdk.noop();try{i=sdk.util.serialize(t.replace("wps_cmd/base64:","")),a=sdk.util.decodeBase64(i),e=sdk.util.decodeBase64(a)}catch(r){return n=r,void sdk.noop()}for(s=e.split("&"),u=0,l=s.length;u<l;u++){if(o=s[u],"clean"===o&&(sdk.noop(),configService.clearLocalStorageData(),sdk.noop()),"stop"===o)return sdk.noop(),this.stop();if("restart"===o)return sdk.noop(),this.restart();/^stop_\d+$/.test(o)&&(c=o.replace("stop_","")-0,sdk.noop(),sdk.tools.observer.fire("window_close",c,constant.TYPE_CLOSE_BY_CMD))}return sdk.noop()},Agent.prototype.popNotifyBubble=function(msg,startTime){var browserInfo,err,error,info,match,wps_process;sdk.service.info.sendMsgTrace("js_start_handle_popup",startTime,msg),sdk.noop();try{match=msg.match(/^([^\/]+)\/base64:(\S+)$/),match&&match[1]&&match[2]&&(msg=match[1],info=sdk.util.decodeBase64(match[2]),info=info.toLowerCase(),sdk.noop())}catch(error){err=error,sdk.noop()}return"process_start"===msg&&info&&(wps_process=eval("("+info+")")||{},["wps.exe","wpp.exe","et.exe"].indexOf(wps_process.processname||"")>-1)?void sdk.noop():(sdk.util.cache.set("currentMsgInfo",info),"browsetheweb"===msg&&sdk.bubble.ifCurrentMsgInfoMatchMaterial()&&this.notifyNameLog(msg),"browsetheweb_common"===msg?(browserInfo=sdk.bubble.parseBrowserInfo(info),browserInfo.top_main&&this.execNotifyBubble("browsetheweb_common_top_main",browserInfo.top_main,startTime),browserInfo.top_all&&this.execNotifyBubble("browsetheweb_common_top_all",browserInfo.top_all,startTime),browserInfo.top_url&&this.execNotifyBubble("browsetheweb_common_top_url",browserInfo.top_url,startTime),browserInfo.multi_url&&this.execNotifyBubble("browsetheweb_common_multi_url",browserInfo.multi_url,startTime),browserInfo.multi_main&&this.execNotifyBubble("browsetheweb_common_multi_main",browserInfo.multi_main,startTime),void(browserInfo.multi_all&&this.execNotifyBubble("browsetheweb_common_multi_all",browserInfo.multi_all,startTime))):this.execNotifyBubble(msg,info,startTime))},Agent.prototype.execNotifyBubble=function(msg,info,startTime){var _info,bo,browserName,custom,i,len1,normal,ref;if(("browsetheweb"===msg||"browsetheweb_common_top_main"===msg)&&info)try{_info=eval("("+info+")"),browserName=_info.name||_info["browserName".toLowerCase()],browserName&&sdk.browser.setLastTop(browserName)}catch(undefined){}for(custom=[],normal=[],ref=this.notifyBoList.concat(this.intervalBoList).concat(this.customBoList),i=0,len1=ref.length;i<len1;i++)bo=ref[i],bo instanceof CustomBubble?custom.push(bo):normal.push(bo);return sdk.service.info.sendMsgTrace("js_start_popup_custom_bubble",startTime,msg,info),this.execCustomBubble(0,custom,msg,info),sdk.service.info.sendMsgTrace("js_start_popup_normal_bubble",startTime,msg,info),this.tryExecNormalBubble(0,normal,msg,info,startTime)},Agent.prototype.processWindowMsg=function(t){var o,e,s,i,n,r,u;try{if("windows_msg_displaychange"===t){for(r=this.getAliveBubble(),u=[],i=0,n=r.length;i<n;i++)o=r[i],!o.view||o instanceof MinisiteBubble||u.push(o.view.moveToRightBottom());return u}}catch(s){return e=s,sdk.noop()}},Agent.prototype.popMsgBubble=function(msg){var body,d64,err,error,json,mb,server,url;this.msgBubbleMap=this.msgBubbleMap||{},this.msgBoList=this.msgBoList||[];try{if(d64=sdk.util.serialize(msg.replace("wps_msg_push/base64:","")),json=eval("("+sdk.util.decodeBase64(d64)+")"),url=json.url,body=json.message,server=json.server,sdk.noop(),this.msgBubbleMap[url]?mb=this.msgBubbleMap[url]:(mb=new MsgBubble(url),mb.observer.on("destroy",function(t){return function(){return t.observer.fire(t.channelBubbleClose),delete t.msgBubbleMap[url]}}(this)),mb.exec(),this.msgBubbleMap[url]=mb,this.msgBoList.push(mb)),mb.isValid())return mb.sendMessage(server,body)}catch(error){return err=error,sdk.noop()}},Agent.prototype.popTestBubble=function(t){var o,e,s,i,n,r,u,l,a,c;sdk.noop(),this.test=!0;try{if("test_close_bubble"===t)return void(this.bubble&&this.bubble.view.destroy());if(this.testArray&&0!==this.testArray.length||(this.testArray=this.notifyBoList.concat(this.intervalBoList).concat(this.customBoList),r=this.testArray.length,sdk.tools.storage.set("test_bubble_number",r)),"test_popup"===t)return 0===this.testArray.length?void sdk.noop():(this.bubble=e=this.testArray.shift(),e.tryExec(),sdk.noop(),sdk.tools.storage.set("test_last_exec_bubble_id",e.config._id),void sdk.tools.storage.set("test_last_exec_bubble_name",sdk.util.encodeBase64(e.config._name)));if(/test_popupbyname_/.test(t)){for(l=t.replace("test_popupbyname_",""),a=this.testArray,c=[],n=0,u=a.length;n<u;n++)o=a[n],o.config._name===l&&o.isValid()?(o.tryExec(),c.push(this.bubble=o)):c.push(void 0);return c}}catch(i){return s=i,sdk.noop()}},Agent.prototype.pushNotifyToDb=function(){var t,o,e,s,i,n,r,u,l,a;if(s="notifyName",u=sdk.util.parseDateTo0amStamp(),t=sdk.util.parseDateTo0amStamp(sdk.util.getIni(s,"date")-0),u!==t){if(sdk.util.db.available())for(o=window.featureConfig&&window.featureConfig.dbName||"feature.db",a=window.featureConfig&&window.featureConfig.dbSourceTable||"feature_source",r=sdk.util.getIni(s,"names").split(";"),e=0,i=r.length;e<i;e++)n=r[e],n&&(l={time:t,type:"notify_history",detail:{name:n,all_day_num:sdk.util.getIni(s,n+"_num")-0}},sdk.util.db.insert(o,a,l,sdk.noop,sdk.noop));return sdk.util.removeIniGroup(s),sdk.util.setIni(s,"date",u)}},Agent.prototype.notifyNameLog=function(t){var o,e,s;return sdk.noop(),o="notifyName",s=sdk.util.getIni(o,t+"_num")-0,sdk.util.setIni(o,t+"_num",s+1),e=sdk.util.getIni(o,"names").split(";"),sdk.util.indexOf(t,e)<0&&e.push(t),sdk.util.setIni(o,"names",e.join(";"))},Agent.prototype.registerProcessMonitor=function(t){var o,e,s,i,n,r,u,l,a;if("ruby"===sdk.platform){for(l={},e=0,i=t.length;e<i;e++)if(o=t[e],"process_start"===o._group_name)for(a=o._group_info.split(";"),s=0,n=a.length;s<n;s++)u=a[s],l[u]||(l[u]=1);r=[];for(u in l)r.push(u);return sdk.client.plugin.registerProcessMonitorList(r)}},Agent.prototype.updateHistory2Ck=function(){return sdk.noop(),sdk.util.ckRec.updateAllHistory(),setInterval(function(){return sdk.util.ckRec.updateAllHistory()},config.update_history_interval)},Agent}(),window.Agent=Agent}).call(this);
(function(){var t;t=function(){function t(){this.appName=sdk.client.info.getAppName(),this.today=sdk.util.formatDate(sdk.util.getNow(),"yyyy_MM_dd"),this.keyReloadNumToday="reload_num_"+this.appName+"_"+this.today,this.keyPluginLoadNumToday="plugin_load_num_"+this.appName+"_"+this.today,this.keyPluginLastLoadTime="plugin_last_load_time_"+this.appName,this.agent=new Agent(function(){return sdk.client.plugin.serviceLoaded()}),this.setPluginLastLoadTime(sdk.util.getNow()),0===Math.floor(1e3*Math.random())&&sdk.util.justSend("http://120.92.93.69:82/report/"+this.appName+"/load/"+this.getPluginLoadNumToday())}return t.prototype.begin=function(){var t;return this.isValidDist()?(this.inValidEnv()?(this.incrPluginLoadNumToday(),this.report(),sdk.noop(),"c++"===sdk.platform&&sdk.client.plugin.enableSceneMsgPush(1),this.agent.start()):(this.incrPluginReloadNumToday(),t=this.getPluginReloadNumToday(),config.maxReloadNumADay>=t?(sdk.noop(),setTimeout(function(){return sdk.client.plugin.upgrade()},6e4)):(sdk.util.justSend("http://pcfg.wps.cn:9002/report/reboot_more_then_3_times"),sdk.noop(),sdk.client.plugin.exit(1e4,"环境异常"))),this.pageReloadInterval=setInterval(function(t){return function(){var e,n;if(e=t.getPluginLastLoadTime().getDate(),n=sdk.util.getNow().getDate(),e!==n&&!t.agent.isDisabledPageReload())return sdk.tools.observer.fire("window_close",-1,constant.TYPE_CLOSE_BY_MIDNIGHT_RELOAD),sdk.client.plugin.exit(1e4,"退出"),sdk.util.justSend("http://pcfg.wps.cn:9002/report/overnight_reload")}}(this),config.page_reload_time_interval),this.ServiceReloadInterval=setInterval(function(t){return function(){return t.agent.hasAliveBubble()||window.featureService&&window.featureService.alive?sdk.noop():t.reload()}}(this),config.service_reload_time_interval)):sdk.client.plugin.exit(1e4,"渠道屏蔽")},t.prototype.start=function(){var t,e;sdk.noop();try{sdk.bubble.setMaterialTagsToIni()}catch(e){t=e,sdk.noop()}return this.setSwitchConfig(function(t){return function(){return"ruby"!==sdk.platform?t.begin():t.getBubble2Config(function(e,n,o){return null==n&&(n="wps.exe"),null==o&&(o=!1),e&&!sdk.client.plugin.isRunInWps()?sdk.client.plugin.runBubbleWithOtherExe(n,o,function(){return sdk.noop(),sdk.client.plugin.exit(1e4),function(){var e,o;return e="run_"+n+"_succeed_"+t.today,o=sdk.tools.storage.get(e)-0,1!==o&&(sdk.tools.storage.set(e,1),sdk.util.justSend("http://pcfg.wps.cn:9002/report/runothersucceed/"+n))}()},function(e){return e?(sdk.noop(),t.begin()):(sdk.noop(),sdk.client.plugin.runBubble2(function(){return sdk.noop(),sdk.client.plugin.exit(1e4),function(){var e,n;return e="run_bubble2_succeed_"+t.today,n=sdk.tools.storage.get(e)-0,1!==n&&(sdk.tools.storage.set(e,1),sdk.util.justSend("http://pcfg.wps.cn:9002/report/runkb2succeed"))}()},function(){return sdk.noop(),t.begin()}))}):(sdk.noop(),t.begin())})}}(this))},t.prototype.stop=function(){if(this.agent.clearBoList(),sdk.util.db.available()&&sdk.util.db.closeAll(),sdk.util.iniCache.clear(),this.pageReloadInterval&&clearInterval(this.pageReloadInterval),this.ServiceReloadInterval)return clearInterval(this.ServiceReloadInterval)},t.prototype.restart=function(){return this.stop(),this.start()},t.prototype.reload=function(){return this.stop(),sdk.noop(),sdk.client.plugin.reload(),setTimeout(function(t){return function(){return sdk.noop(),window.location.reload(!1)}}(this),3e4)},t.prototype.inValidEnv=function(){var t;return t=sdk.client.info.getAppVersion()||"",!function(e){return function(){var n,o;return o=new Date-0,n="evn_check_timestamp",sdk.util.setIni(e.appName,n,o),sdk.util.getIni(e.appName,n)!==o+""&&(sdk.util.justSend("http://pcfg.wps.cn:9002/report/appName_"+e.appName+"/clientVersion_"+t+"/set_ini_failed"),sdk.noop(),!0)}}(this)()},t.prototype.isValidDist=function(){return!function(t){return function(){return!("pptassist"!==t.appName||!/^80\.267/.test(sdk.client.info.getDistNum()))}}(this)()&&(!function(t){return function(){return!("te"!==t.appName||!/^40\.539|40\.115/.test(sdk.client.info.getDistNum()))}}(this)()&&!function(t){return function(){return!("powerword"!==t.appName||!/^800\.3059|800\.3061|800\.3154|800\.3155|800\.159/.test(sdk.client.info.getDistNum()))}}(this)())},t.prototype.report=function(){var t,e,n;if("1.0.5.58"===sdk.client.info.getPlgVersion()&&0===Math.floor(10*Math.random())&&sdk.util.justSend("http://pcfg.wps.cn:9002/report/load58_2/"+(1===this.getPluginLoadNumToday())),0===Math.floor(1e3*Math.random())&&sdk.util.justSend("http://pcfg.wps.cn:9002/report/"+this.appName+"/load/"+this.getPluginLoadNumToday()),t="production"===sdk.env?.001:1,0===Math.floor(Math.random()/t)&&1===this.getPluginLoadNumToday())return n=/^\/wps_assets/.test(window.location.pathname)?"wps_assets":"old_version",e=window.location.protocol,sdk.util.justSend("http://pcfg.wps.cn:9002/report/"+this.appName+"/"+e+"/"+n+"/"+t)},t.prototype.popBubbleByNotifyGroup=function(t,e){if("upgrade_bubble"!==t&&"upgrade_wps"!==t||(t="wps_upgrade"),sdk.noop(),t||this.inValidEnv()){sdk.service.info.sendMsgTrace("js_service_receive",e,t);try{return this.agent.receiveMessage(t,e),1}catch(n){return-1}}},t.prototype.setSwitchConfig=function(t){return sdk.noop(),sdk.util.httpGet("//switch.pcfg.cache.wpscdn.cn/wps_assets/cfg/ad/switch/bubble",{},function(e){return function(e){var n,o,i,s,r,u,a,d,l,p;sdk.noop();try{if(/-1\s*/.test(e))window.config.enable=!1;else{for(l={},o=e.split("\n"),r=0,d=o.length;r<d;r++)n=o[r],u=n.indexOf("="),a=n.substr(0,u),p=n.substr(u+1),isNaN(p-0)||(p-=0),window.config[a]=p;window.config.enable=!0}}catch(s){i=s,sdk.noop()}return t&&t()}}(this),function(e){return function(e){return sdk.noop(),t&&t()}}(this))},t.prototype.getBubble2Config=function(t){return sdk.noop(),sdk.util.httpGet("//switch.pcfg.cache.wpscdn.cn/wps_assets/cfg/ad/switch/wps_load_bubble",{},function(e){return function(e){var n,o,i,s,r,u,a,d,l;sdk.noop();try{for(d=["wps.exe","wpp.exe","et.exe","wpscenter.exe","wpscloudsvr.exe"],o=e.split("\n"),l={},r=0,a=o.length;r<a;r++)n=o[r],u=n.indexOf("="),l[n.substr(0,u)]=n.substr(u+1)-0;if(null!=l.on&&(3===l.process||!(sdk.util.indexOf("qg",sdk.as.getAsProcess("name"))>-1||sdk.util.indexOf("qg",sdk.as.getAsInstall("name"))>-1)))return t(l.on,d[l.process],l.uac);if(/^11\./.test(sdk.client.info.getAppVersion()))return t(!0,d[3])}catch(s){i=s,sdk.noop()}return t&&t(!1)}}(this),function(e){return function(e){return sdk.noop(),t&&t(!1)}}(this))},t.prototype.incrPluginLoadNumToday=function(){var t;return t=this.getPluginLoadNumToday(),sdk.tools.storage.set(this.keyPluginLoadNumToday,++t)},t.prototype.getPluginLoadNumToday=function(){return sdk.tools.storage.get(this.keyPluginLoadNumToday)-0||0},t.prototype.setPluginLastLoadTime=function(t){return null==t&&(t=0),sdk.tools.storage.set(this.keyPluginLastLoadTime,t-0)},t.prototype.getPluginLastLoadTime=function(){var t;return t=sdk.tools.storage.get(this.keyPluginLastLoadTime)-0||0,new Date(t)},t.prototype.incrPluginReloadNumToday=function(){var t;return t=this.getPluginReloadNumToday()-0||0,sdk.tools.storage.set(this.keyReloadNumToday,++t)},t.prototype.getPluginReloadNumToday=function(){return sdk.tools.storage.get(this.keyReloadNumToday)},t}(),window.service=new t,window.service.start()}).call(this);
// 078B691BFE47CC38168679071AC708EA17E1D402FFBFAD8406BCC3072B740619D268D558FCE57C4ED05E106AE216971DE83B1B5E3DD4BAF17CC3A5EEEF8F21CC